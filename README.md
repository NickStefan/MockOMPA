# MockOMPA.py

## Current Outputs: [nickstefan.pythonanywhere.com](http://nickstefan.pythonanywhere.com)

#### Dependencies:
* Scrapy python webscraping library release 0.20.2
* python 2.7

#### Refactoring Completed 6/22/14
* Refactored code to be much more DRY
* Moved most of the variables and results storage into dictionaries and arrays
* Created wrapper functions to loop through actions and use callback functions
* Redesigned the output file writing to abstraction functions

#### Use
* $ python ompascrapymanager.py
* $ python mockompa.py /sub/directory/filename.txt

#### Description
* Scrapes the OMPA website and scores an OMPA style championship meet
* Swimmers are automatically entered into only their best events
* Includes Free and Medley Relays

#### Text Output File
* The total predicted team scores
* Team score broken down by stroke
* Scores broken down by interesting macro groups: 8/under, 9/12, and 13/up
* Age group scores
* Event by Event meet results
* No swimmer names are outputted to the text file

#### Bugs & Inaccuracies
* Ties don't split points, but simply both get the same points
* 'Vacation' swimmers are obviously not excluded

#### Why A Mock OMPA?
* For fun; it's like how football has in-season power rankings and BCS polls
* It's not supposed to 'predict' anything. If team A is ranked 3rd early in the year, but ends up in second I don't view that as the 'prediction' being wrong. Instead it's just that things changed, and people got faster/slower.
* I'm curious to see if there's any ebb and flow during the season.
* I've always heard stories of "Team X outswam the program by 300 points", and I thought it would be cool to chart how much each team swims ahead or behind of their in-season points.

#### Flow of Data:
* ompascrapymanager.py
  * instances a webcrawler for every age group gender swim event
  * each of these scrape their swimmer data into a JSON file

* mockOMPA.py:
  * _description_
  * _input --> wrapper function; uses callback --> output_
  * LOAD THE INDIVIDUAL-EVENT JSON FILES (GENERATED BY WEB SCRAPER)
  * Array of file system paths for .json files --> ParseScrapyData() internally uses LoadScrapyData() --> Array of Age Group Strokes
  * MATCH THE SWIMMERS FROM DIFFERENT EVENT JSON FILES 
  * Array of Age Group Strokes --> SortWholeAgeGroupGender() internally uses callback ReOrderStrokes() --> AgeGroupGender Array
  * REPLACE SWIMMER NAMES WITH TEAM NAME AND SORT INTO TEAMS
  * AgeGroupGender Array --> AgeGroupWrapper() uses callback SortTeamSwimmers() --> TeamAgeGroupGender Array
  * ENTER SWIMMERS INTO ONLY THEIR BEST 3 EVENTS (2 FOR 6/UNDERS)S
  * TeamAgeGroupGender Array --> AgeGroupDoubleWrapper() uses callback PickEvents() --> TeamAgeGroupGender Array
  * ACTUALLY FILL THE EVENTS AND SORT THEM FASTEST TO SLOWEST
  * TeamAgeGroupGender Array --> AgeGroupWrapper() uses callback FillEvents() --> AgeGroupGenderEvents Array
  * SCORE THE MEET
  * AgeGroupGenderEvents --> ScoreEventsWrapper() uses callback ScoreEvent() --> EventPoints and EventResults

#### Web Presentation:
* The web presentation folder contains the css and javascript files that create [swimsolo.com/mockompa](http://www.swimsolo.com/mockompa)
* These files are admittedly not standalone, as the html template is loaded using django templating
